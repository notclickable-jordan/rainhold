# Run with docker compose up -d
services:
    dozzle:
        image: amir20/dozzle:latest
        container_name: dozzle
        volumes:
            - /var/run/docker.sock:/var/run/docker.sock
        environment:
            - DOZZLE_ENABLE_ACTIONS=true
            - DOZZLE_ENABLE_SHELL=true
            - DOZZLE_AUTH_PROVIDER=forward-proxy
            - DOZZLE_AUTH_HEADER_USER=X-Forwarded-User
            - DOZZLE_AUTH_HEADER_EMAIL=X-Forwarded-User
            - DOZZLE_AUTH_HEADER_NAME=X-Forwarded-User
        labels:
            traefik.enable: true
            traefik.http.routers.dozzle.rule: Host(`dozzle.notclickable.com`)
            traefik.http.routers.dozzle.middlewares: tinyauth@docker
            traefik.http.routers.dozzle.tls.certresolver: cloudflare
            traefik.http.routers.dozzle.entrypoints: websecure
            traefik.http.services.dozzle.loadbalancer.server.port: 8080
        networks:
            - proxy
networks:
    proxy:
        external: true
